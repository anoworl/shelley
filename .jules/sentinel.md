## 2025-05-27 - Path Traversal in File Serving Handler
**Vulnerability:** A path traversal vulnerability was found in `handleRead` in `server/handlers.go`. The handler accepted a `path` query parameter and checked if it started with a specific allowed directory prefix using `strings.HasPrefix`. However, it did not clean the path before this check, allowing attackers to use `../` sequences to traverse out of the allowed directory after the prefix match (e.g., `/allowed/../etc/passwd`).
**Learning:** `strings.HasPrefix` is insufficient for validating file paths when user input can contain `..` or other traversal characters. The path must be canonicalized before validation.
**Prevention:** Always use `filepath.Clean()` (or `filepath.Abs()` if dealing with absolute paths) to resolve directory traversal sequences before performing any prefix checks or access control logic. Ensure the prefix check includes a trailing separator to prevent partial name matching (e.g., `/tmp/dir` matching `/tmp/directory`).

## 2026-01-17 - Arbitrary File Write in `handleWriteFile`
**Vulnerability:** The `handleWriteFile` function in `server/handlers.go` allowed writing to any file on the filesystem as long as the path was absolute. Although there was a comment stating "require the path to be within a git repository", there was no code enforcing this restriction. This allowed an attacker to overwrite critical system files or write new files to arbitrary locations.
**Learning:** Comments are not code. Security restrictions must be explicitly implemented and verified. Reliance on future implementation of security checks ("For now...") is a significant risk if the code is deployed before those checks are added.
**Prevention:** Implemented a check using `getGitRoot` to verify that the target file's directory resides within a valid git repository. If the check fails (either the directory doesn't exist or isn't in a git repo), the request is rejected with a 403 Forbidden status. This confines write operations to the intended project scope.
